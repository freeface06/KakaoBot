const { KakaoLinkClient } = require("KakaoLink");
const kakao = new KakaoLinkClient(
  "ed6fdb7fc987bcf0f48ef46425f0ac0e",
  "https://loawa.com"
);
kakao.login("hjlee@bluedata.kr", "dlghwjd123!!!");

let ì˜ì—… = "OFF";

let í‰ì¼ = [18, 24];

let ì£¼ë§ = [14, 24];

let ìš´ì˜ì‹œê°„ì•„ë‹˜ =
  "ğŸ˜›ì£„ì†¡í•©ë‹ˆë‹¤,\nì§€ê¸ˆì€ ìš´ì˜ì‹œê°„ì´ ì•„ë‹™ë‹ˆë‹¤.\n\nâ¤ìš´ì˜ì‹œê°„â¤\nâ° í‰ì¼ : " +
  í‰ì¼[0] +
  ":00 ~ " +
  í‰ì¼[1] +
  ":00\nâ° ì£¼ë§ : " +
  ì£¼ë§[0] +
  ":00 ~ " +
  ì£¼ë§[1] +
  ":00\n\në¬¸ì˜/ìºë¦­í„°ëª…/í´ë˜ìŠ¤/í…œë ˆë²¨/ë¬¸ì˜ë‚´ìš©\nì˜ˆ)ë¬¸ì˜/ëª°ë§ì¸„/ë°”ë“œ/1591/ê°€ì…ë¬¸ì˜\nìœ¼ë¡œ ë¬¸ì˜ë‚¨ê¸°ê³  ê¸°ë‹¤ë ¤ì£¼ì‹œë©´,\nìˆœì°¨ì ìœ¼ë¡œ ì—°ë½ë“œë¦¬ê² ìŠµë‹ˆë‹¤.ğŸ¤—";

const prefix = "ë†ë¶€ì¿¤";

function response(room, msg, sender, isGroupChat, replier, imageDB, packageName) {
    if (room == "ìëª½í•´ ê°€ì…ë¬¸ì˜ë°©") {
        let date = new Date();
        let ìš”ì¼ = dateFormat(date).split(" ")[0];
        let ì‹œê°„ = dateFormat(date).split(" ")[1];
        
        let search = msg.split(" ");
        if (search[0] == prefix) {
            if (search[1] == "ì‹œì‘") {
              ì˜ì—… = "ON";
              ì•Œë¦¼("ìƒë‹´ ON", room);
              return;
            }
        
            if (search[1] == "ì¢…ë£Œ") {
              ì˜ì—… = "OFF";
              ì•Œë¦¼("ìƒë‹´ OFF", room);
              return;
            }
        
            if (search[1] == "ìƒíƒœ") {
              ì•Œë¦¼("ìƒë‹´ " + ì˜ì—…, room);
              return;
            }
        
            if (search[1] == "ëŒ€ê¸°") {
              let ëŒ€ê¸°ëª©ë¡ = "";
              for (let i = 0; i < ëŒ€ê¸°.length; i++) {
                if (i + 1 == ëŒ€ê¸°.length) {
                  ëŒ€ê¸°ëª©ë¡ += i + 1 + " : " + ëŒ€ê¸°[i];
                } else {
                  ëŒ€ê¸°ëª©ë¡ += i + 1 + " : " + ëŒ€ê¸°[i] + "\n";
                }
              }
        
              if (ëŒ€ê¸°ëª©ë¡ == "") {
                ì•Œë¦¼("ëŒ€ê¸°ëª©ë¡ì´ ì—†ìŠµë‹ˆë‹¤.ğŸ’¦", room);
              } else {
                ì•Œë¦¼(ëŒ€ê¸°ëª©ë¡, room);
              }
              return;
            }
        
            if (search[1] == "ì‚­ì œ") {
              ëŒ€ê¸° = [];
              ì•Œë¦¼("ğŸ—‘ëŒ€ê¸°ëª©ë¡ì„ ëª¨ë‘ ë¹„ì› ìŠµë‹ˆë‹¤.", room);
              return;
            }
        
            if (search[1] == "ì´ˆëŒ€") {
              replier.reply(
                "ğŸ§ë””ìŠ¤ì½”ë“œì£¼ì†ŒğŸ§\n\nhttps://discord.gg/wgaE3HppUg\n\nğŸ“±ì˜¤í”ˆí†¡ì£¼ì†ŒğŸ“±\n\nhttps://open.kakao.com/o/gvLfruhe\n\nì˜¤í”ˆí†¡ ì°¸ì—¬ëŠ” ììœ¨ì´ì§€ë§Œ ì˜¤ì‹œë©´ ê¸¸ë“œì—ë” ë¹ ë¥´ê²Œ ì ì‘í•˜ì‹¤ ìˆ˜ ìˆì„ê±°ì—ìš”! \ní•˜ì§€ë§Œ ë””ì½”ë„ í™œë°œí•˜ê¸°ë•Œë¬¸ì— ì•ˆë“¤ì–´ì˜¤ì…”ë„ ì „í˜€ ë¬¸ì œì—†ê³  í›„ì— ë“¤ì–´ì˜¤ê³  ì‹¶ì„ë•Œ ì˜¤ì…”ë‘ ë˜ë‚˜ ê³¼í•œ ë“¤ë½ë‚ ë½ì€ ì‚¼ê°€í•´ì£¼ì„¸ìš© (ë¹„ë²ˆ 0505)\n\në””ì½”ëŠ” í•„ì°¸ì…ë‹ˆë‹¤ ë“¤ì–´ì˜¤ì…”ì„œ ì¸ê²Œì„ ë‹‰ìœ¼ë¡œ ë³€ê²½í•´ì£¼ì‹œë©´ ì—­í• ì§€ê¸‰ í•´ë“œë¦´ê²Œìš”! ê³µì§€ì‚¬í•­ê³¼ ìëª½ê·œì¹™ ê²Œì‹œê¸€ í•œë²ˆì”©ë§Œ ì •ë… ë¶€íƒë“œë¦¬ê³  ê·œì¹™ì„ ìˆ™ì§€í•˜ì§€ ì•Šì•„ ì¼ì–´ë‚˜ëŠ” ëª¨ë“  ì¼ì€ ì±…ì„ì§€ì§€ì•ŠìŠµë‹ˆë‹¤!\n\ní™•ì¸ë˜ì…¨ìœ¼ë©´ ì¹´í†¡ë¬¸ì˜ë°©ì€ ë‚˜ê°€ì£¼ì‹œê³ \n\nìëª½í•´ ê¸¸ë“œì— ë¨¸ë¬´ëŠ” ë™ì•ˆ ì¦ê²ê³  ì¢‹ì€ ì¶”ì–µ ë§ì´ ë§Œë“¤ì–´ê°€ì„¸ìš”!! í™˜ì˜í•©ë‹ˆë‹¤:)"
              );
              return;
            }
        }

        if (ì˜ì—… == "OFF") {
            if (ìš”ì¼ == "í† " || ìš”ì¼ == "ì¼") {
              if (ì‹œê°„ < ì£¼ë§[0] || ì‹œê°„ > ì£¼ë§[1]) {
                replier.reply(ìš´ì˜ì‹œê°„ì•„ë‹˜);
                return;
              }
            } else {
              if (ì‹œê°„ < í‰ì¼[0] || ì‹œê°„ > í‰ì¼[1]) {
                replier.reply(ìš´ì˜ì‹œê°„ì•„ë‹˜);
                return;
              }
            }
          }
      }
}

function dateFormat(date) {
    let week_arr = ["ì¼", "ì›”", "í™”", "ìˆ˜", "ëª©", "ê¸ˆ", "í† "];
  
    let hour = date.getHours();
    let week = date.getDay();
  
    hour = hour >= 10 ? hour : hour;
  
    if (hour == 0) {
      hour = 24;
    }
  
    return week_arr[week] + " " + hour;
  }

  function ì•Œë¦¼(ë©”ì„¸ì§€, room) {
    let ì•Œë¦¼ = [78709, 78710];
    let ran = Math.floor(Math.random() * ì•Œë¦¼.length);
  
    let obj = {
      link_ver: "4.0",
      template_id: ì•Œë¦¼[ran],
      template_args: {
        msg: ë©”ì„¸ì§€,
      },
    };
    kakao.sendLink(room, obj, "custom");
  }